<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>xgxr Overview • xgxr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="xgxr Overview">
<meta property="og:description" content="xgxr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xgxr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/xgxr_overview.html">xgxr Overview</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Novartis/xgxr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>xgxr Overview</h1>
                        <h4 data-toc-skip class="author">Andrew Stein,
Fariba Khanshan, Alison Margolskee</h4>
            
            <h4 data-toc-skip class="date">2023-10-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Novartis/xgxr/blob/HEAD/vignettes/xgxr_overview.Rmd" class="external-link"><code>vignettes/xgxr_overview.Rmd</code></a></small>
      <div class="hidden name"><code>xgxr_overview.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The xgxr package supports a structured approach to exploring PKPD
data (<a href="https://opensource.nibr.com/xgx/" class="external-link">outlined here</a>). It
also contains helper functions for enabling the modeler to follow best R
practices (by appending the program name, figure name location, and
draft status to each plot) and enabling the modeler to follow best
graphical practices (by providing an xgx theme that reduces chart ink,
and by providing time-scale, log-scale, and reverse-log-transform-scale
functions for more readable axes).</p>
</div>
<div class="section level2">
<h2 id="required-packages">Required Packages<a class="anchor" aria-label="anchor" href="#required-packages"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://opensource.nibr.com/xgx/" class="external-link">xgxr</a></span><span class="op">)</span></span></code></pre></div>
<!-- ## Data exploration
 This package offers two frameworks for exploring data 

1. Generate an Rmarkdown shell using `xgx_create_rmarkdown()`, which the user then edits with their dataset and column names.   This Rmarkdown document relies on the `dplyr` and `ggplot2` packages, in addition to some add-on functionality to `ggplot2` that is provided by the `xgx` package.  The Rmarkdown document is designed to be easy for the modeler to customize as needed.
2. Create a single page of overview of the data using the function `xgx_PK_summary` (and other functions to be added).  This function is meant to provide a quick overview of the data on one page, but is not as customizable as the Rmarkdown document

### Rmarkdown shell for data exploration
To create a shell Rmarkdown with the code for exploring data, use `xgx_create_rmarkdown`.  Currently, only the "pk" type is implemented.


```r
# xgx_create_rmarkdown(type = "pk", open_file = FALSE)
```

### PK summary plots
Function to make key plots of pharmacokinetic (PK) data. 


```r
#if (sessionInfo()$otherPkgs$ggplot2$Version == "2.2.1") {
#   nsubj <- 50
#   ntime <- 8
#   time <- rep(c(1, 2, 4, 8, 12, 24, 36, 48), nsubj)
#   id <- sort(rep(seq(1, nsubj), ntime))
#   trt <- sort(rep(c(25, 50, 100, 150, 300), ntime * nsubj / 5))
#   ka <- rep(rlnorm(nsubj, -0.5, 0.3), each = ntime)
#   ke <- rep(rlnorm(nsubj, -3, 0.3), each = ntime)
#   conc <- trt * (ka * ke / (ka - ke)) * (exp(-time * ke) - exp(-time * ka)) * (rep(stats::rlnorm(ntime * nsubj, 0.3, 0.1)))
 
#   data <- data.frame(TIME = time, CONC = conc, ID = id, TRT = trt)
#   xgx_PK_summary(data = data, labels = list(TRT = "Dose"),
#                  units_dataset = list(TIME = "Hours", CONC = "ng/mL", TRT = "mg"))
#} else {
#  print("Currently only works with ggplot2 version 2.2.1 (on DaVinci), and not version 3")
#}
```
-->
</div>
<div class="section level2">
<h2 id="traceability-annotating-and-saving-plots-and-tables">Traceability: annotating and saving plots and tables<a class="anchor" aria-label="anchor" href="#traceability-annotating-and-saving-plots-and-tables"></a>
</h2>
<div class="section level3">
<h3 id="annotating-figures">Annotating figures<a class="anchor" aria-label="anchor" href="#annotating-figures"></a>
</h3>
<p>Our best practices require that we mark plots as “DRAFT” if not yet
final, and also list the program that created the plot and the location
where the plot is stored. This helps with the traceability of the work,
by ensuring that the following information is available for every plot
in a report: the R script used to create the figure, the location where
the figure is stored, and the time and date when the figure was created.
The key function is: * <code>xgx_annotate_status</code> allows for the
addition of text (like the word draft) to the plots * The caption is set
to contain the file directory, program name, output name, and time of
creation</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">caption</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"File_Directory"</span>,<span class="st">"\n"</span>,</span>
<span>                <span class="st">"Progam_Name.Rmd"</span>, <span class="st">"\n"</span>,</span>
<span>                <span class="st">"Output_Name.html"</span>,<span class="st">"\n"</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                collapse <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="va">ggcaption</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="va">caption</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, y <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/xgx_annotate_status.html">xgx_annotate_status</a></span><span class="op">(</span>status <span class="op">=</span> <span class="st">"DRAFT"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">ggcaption</span></span>
<span>  </span></code></pre></div>
<p>The the function <code>xgx_save</code> works only with ggplot
objects. If the figure that is created is not a ggplot object, it will
not work. An alternative is to use <code>xgx_annotate_status_png</code>
to add the status and filename to png files.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, y <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">filename</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"png_example.png"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="va">filename</span>, plot <span class="op">=</span> <span class="va">g</span>, height <span class="op">=</span> <span class="fl">4</span>, width <span class="op">=</span> <span class="fl">4</span>, dpi <span class="op">=</span> <span class="fl">75</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/xgx_annotate_status_png.html">xgx_annotate_status_png</a></span><span class="op">(</span><span class="va">filename</span>, <span class="st">"./ExampleScript.R"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Add footnote to /tmp/RtmpsnQL7V/png_example.png</span></span></code></pre></div>
<!-- ![image](png_example.png) -->
</div>
</div>
<div class="section level2">
<h2 id="graphics-helpers">Graphics helpers<a class="anchor" aria-label="anchor" href="#graphics-helpers"></a>
</h2>
<div class="section level3">
<h3 id="xgx-theme">xgx theme<a class="anchor" aria-label="anchor" href="#xgx-theme"></a>
</h3>
<p>The <code><a href="../reference/xgx_theme.html">xgx_theme()</a></code> function includes the xGx recommended
plot settings. It sets the background to white with light grey lines for
the major and minor breaks. This minimizes chart ink as recommended by
Edward Tufte. You can add <code><a href="../reference/xgx_theme.html">xgx_theme()</a></code> to an existing
<code>ggplot</code> object, or you can call <code><a href="../reference/xgx_plot.html">xgx_plot()</a></code> in
place of <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> for all of your plot initiations.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span>, y <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>You may wish to set the theme to <code>xgx_theme</code> for your R
session, as we do below.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="../reference/xgx_theme.html">xgx_theme</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Alternative, equivalent function:</span></span>
<span><span class="fu"><a href="../reference/xgx_theme_set.html">xgx_theme_set</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<!-- ### Spaghetti plot
Spaghetti plots combine dots and lines, grouped and colored by individuals onto one plot. Try out `xgx_geom_spaghetti` which combines `geom_point()` and `geom_line()` into one `geom`, grouping and coloring by the `group` aesthetic. Calling `xgx_spaghetti` further combines `xgx_plot()` and `xgx_geom_spaghetti()` into one line.
-->
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># time &lt;- rep(seq(1,10),5)</span></span>
<span><span class="co"># id &lt;- sort(rep(seq(1,5), 10))</span></span>
<span><span class="co"># conc &lt;- exp(-time)*sort(rep(rlnorm(5),10))</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># data &lt;- data.frame(time = time, concentration  = conc, id = factor(id))</span></span>
<span><span class="co"># xgx_plot() + xgx_geom_spaghetti(data = data, mapping = aes(x = time, y = concentration, group = id, color = id))</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># xgx_spaghetti(data = data, mapping = aes(x = time, y = concentration, group = id, color = id))</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="confidence-intervals">Confidence intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals"></a>
</h3>
<p>The code for confidence intervals is a bit complex and hard to
remember. Rather than copy-pasting this code we provide the function
<code>xgx_stat_ci</code> for calculating and plotting default confidence
intervals and also <code>xgx_geom_ci</code> for percentile intervals.
<code>xgx_stat_ci</code> allows the definition of multiple
<code>geom</code> options in one function call, defined through a list.
The default is <code>geom = list("point","line","errorbar")</code>.
Additional ggplot options can be fed through the <code>ggplot</code>
object call, or the <code>xgx_stat_ci</code> layer. (Note that
<code>xgx_stat_ci</code> and <code>xgx_geom_ci</code> are equivalent).
<code>xgx_stat_pi</code> and <code>xgx_geom_pi</code> work in a similar
fashion but for percentile intervals.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>                   y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">60</span><span class="op">)</span>,</span>
<span>                   group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span><span class="va">data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/xgx_stat_ci.html">xgx_stat_ci</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-9-1.png" width="384"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span><span class="va">data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/xgx_stat_pi.html">xgx_stat_pi</a></span><span class="op">(</span>percent <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-9-2.png" width="384"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span><span class="va">data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/xgx_stat_ci.html">xgx_stat_ci</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">.95</span>, geom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"pointrange"</span>,<span class="st">"line"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-9-3.png" width="384"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span><span class="va">data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/xgx_stat_ci.html">xgx_stat_ci</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">.95</span>, geom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"ribbon"</span>,<span class="st">"line"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-9-4.png" width="384"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span><span class="va">data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">group</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="../reference/xgx_stat_ci.html">xgx_stat_ci</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">.95</span>, alpha <span class="op">=</span>  <span class="fl">0.5</span>,</span>
<span>                position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-9-5.png" width="384"></p>
<p>The default settings calculate the confidence interval based on the
Student t Distribution (assuming normally distributed data). You can
also specify “lognormal”“,”binomial”” or “multinomial”” for the
<code>distribution</code>. The first will perform the confidence
interval operation on the log-scaled data, the second uses the binomial
exact confidence interval calculation from the <code>binom</code>
package, and the third uses <code>MultinomCI</code> from the
<code>DescTools</code> package. The “multinomial”” option is used for
ordinal response or categorical data.</p>
<p>Note: you DO NOT need to use both
<code>distribution = "lognormal"</code> and
<code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10()</a></code>, choose only one of these.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plotting lognormally distributed data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>                   y <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">60</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span> <span class="fu"><a href="../reference/xgx_stat_ci.html">xgx_stat_ci</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">0.95</span>, distribution <span class="op">=</span> <span class="st">"lognormal"</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-10-1.png" width="384"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> </span>
<span><span class="co"># note: you DO NOT need to use both distribution = "lognormal" and scale_y_log10()</span></span>
<span><span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span><span class="va">data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span> <span class="fu"><a href="../reference/xgx_stat_ci.html">xgx_stat_ci</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-10-2.png" width="384"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># plotting binomial data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>                  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span> <span class="fu"><a href="../reference/xgx_stat_ci.html">xgx_stat_ci</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">0.95</span>, distribution <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-10-3.png" width="384"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="co"># Example plotting the percent of subjects in a categorical covariate group by treatment.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">120</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Trt1"</span>, <span class="st">"Trt2"</span>, <span class="st">"Trt3"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                 covariate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"White"</span>,<span class="st">"Black"</span>,<span class="st">"Asian"</span>,<span class="st">"Other"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>                                    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"White"</span>, <span class="st">"Black"</span>, <span class="st">"Asian"</span>, <span class="st">"Other"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="../reference/xgx_stat_ci.html">xgx_stat_ci</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">response</span>, response <span class="op">=</span> <span class="va">covariate</span><span class="op">)</span>,</span>
<span>             distribution <span class="op">=</span> <span class="st">"ordinal"</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="../reference/xgx_stat_ci.html">xgx_stat_ci</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, response <span class="op">=</span> <span class="va">covariate</span><span class="op">)</span>, geom <span class="op">=</span> <span class="st">"hline"</span>,</span>
<span>             distribution <span class="op">=</span> <span class="st">"ordinal"</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">covariate</span><span class="op">)</span> <span class="op">+</span> </span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Treatment group"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Percent of subjects by category"</span><span class="op">)</span></span>
<span><span class="co">#&gt; In xgx_stat_ci: </span></span>
<span><span class="co">#&gt;   The following aesthetics are identical to response: PANEL</span></span>
<span><span class="co">#&gt;   These will be used for differentiating response groups in the resulting plot.</span></span>
<span><span class="co">#&gt; In xgx_stat_ci: </span></span>
<span><span class="co">#&gt;   The following aesthetics are identical to response: PANEL</span></span>
<span><span class="co">#&gt;   These will be used for differentiating response groups in the resulting plot.</span></span>
<span><span class="co">#&gt; In xgx_stat_ci: </span></span>
<span><span class="co">#&gt;   The following aesthetics are identical to response: PANEL</span></span>
<span><span class="co">#&gt;   These will be used for differentiating response groups in the resulting plot.</span></span>
<span><span class="co">#&gt; In xgx_stat_ci: </span></span>
<span><span class="co">#&gt;   The following aesthetics are identical to response: PANEL</span></span>
<span><span class="co">#&gt;   These will be used for differentiating response groups in the resulting plot.</span></span>
<span><span class="co">#&gt; Warning: Unknown or uninitialised column: `flipped_aes`.</span></span>
<span><span class="co">#&gt; Unknown or uninitialised column: `flipped_aes`.</span></span>
<span><span class="co">#&gt; Warning: Unknown or uninitialised column: `width`.</span></span>
<span><span class="co">#&gt; Warning: Unknown or uninitialised column: `linewidth`.</span></span>
<span><span class="co">#&gt; Warning: Unknown or uninitialised column: `size`.</span></span>
<span><span class="co">#&gt; Warning: Unknown or uninitialised column: `linewidth`.</span></span>
<span><span class="co">#&gt; Warning: Unknown or uninitialised column: `size`.</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-10-4.png" width="384"></p>
<p><code>xgx_stat_ci</code> can now also cut data by quantiles of
<code>x</code> using the <code>bins</code> option,
e.g. <code>bins = 4</code> will cut the data by quartiles of
<code>x</code>. You can also supply your own breaks to cut the data.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># plotting </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">120</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mild"</span>,<span class="st">"Moderate"</span>,<span class="st">"Severe"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>              covariate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>,<span class="st">"Female"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>y <span class="op">=</span> <span class="op">(</span><span class="fl">50</span> <span class="op">+</span> <span class="fl">20</span><span class="op">*</span><span class="va">x</span><span class="op">/</span><span class="op">(</span><span class="fl">200</span> <span class="op">+</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plotting a lognormally distributed variable by quartiles of x</span></span>
<span><span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/xgx_stat_ci.html">xgx_stat_ci</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, colour <span class="op">=</span> <span class="va">covariate</span><span class="op">)</span>,</span>
<span>              distribution <span class="op">=</span> <span class="st">"lognormal"</span>, bins <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># plotting ordinal or multinomial data, by quartiles of x</span></span>
<span><span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/xgx_stat_ci.html">xgx_stat_ci</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, response <span class="op">=</span> <span class="va">response</span>, colour <span class="op">=</span> <span class="va">covariate</span><span class="op">)</span>,</span>
<span>              distribution <span class="op">=</span> <span class="st">"ordinal"</span>, bins <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">response</span><span class="op">)</span></span>
<span><span class="co">#&gt; In xgx_stat_ci: </span></span>
<span><span class="co">#&gt;   The following aesthetics are identical to response: PANEL</span></span>
<span><span class="co">#&gt;   These will be used for differentiating response groups in the resulting plot.</span></span>
<span><span class="co">#&gt; In xgx_stat_ci: </span></span>
<span><span class="co">#&gt;   The following aesthetics are different from response: colour</span></span>
<span><span class="co">#&gt;   These will be used to divide the data into different groups before calculating summary statistics on the response.</span></span>
<span><span class="co">#&gt; In xgx_stat_ci: </span></span>
<span><span class="co">#&gt;   The following aesthetics are identical to response: PANEL</span></span>
<span><span class="co">#&gt;   These will be used for differentiating response groups in the resulting plot.</span></span>
<span><span class="co">#&gt; In xgx_stat_ci: </span></span>
<span><span class="co">#&gt;   The following aesthetics are different from response: colour</span></span>
<span><span class="co">#&gt;   These will be used to divide the data into different groups before calculating summary statistics on the response.</span></span>
<span><span class="co">#&gt; In xgx_stat_ci: </span></span>
<span><span class="co">#&gt;   The following aesthetics are identical to response: PANEL</span></span>
<span><span class="co">#&gt;   These will be used for differentiating response groups in the resulting plot.</span></span>
<span><span class="co">#&gt; In xgx_stat_ci: </span></span>
<span><span class="co">#&gt;   The following aesthetics are different from response: colour</span></span>
<span><span class="co">#&gt;   These will be used to divide the data into different groups before calculating summary statistics on the response.</span></span>
<span><span class="co">#&gt; Warning: Unknown or uninitialised column: `flipped_aes`.</span></span>
<span><span class="co">#&gt; Unknown or uninitialised column: `flipped_aes`.</span></span>
<span><span class="co">#&gt; Warning: Unknown or uninitialised column: `width`.</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-11-2.png" width="672"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/xgx_stat_ci.html">xgx_stat_ci</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, response <span class="op">=</span> <span class="va">response</span>, colour <span class="op">=</span> <span class="va">response</span><span class="op">)</span>,</span>
<span>              distribution <span class="op">=</span> <span class="st">"ordinal"</span>, bins <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">covariate</span><span class="op">)</span></span>
<span><span class="co">#&gt; In xgx_stat_ci: </span></span>
<span><span class="co">#&gt;   The following aesthetics are identical to response: colour</span></span>
<span><span class="co">#&gt;   These will be used for differentiating response groups in the resulting plot.</span></span>
<span><span class="co">#&gt; In xgx_stat_ci: </span></span>
<span><span class="co">#&gt;   The following aesthetics are different from response: PANEL</span></span>
<span><span class="co">#&gt;   These will be used to divide the data into different groups before calculating summary statistics on the response.</span></span>
<span><span class="co">#&gt; In xgx_stat_ci: </span></span>
<span><span class="co">#&gt;   The following aesthetics are identical to response: colour</span></span>
<span><span class="co">#&gt;   These will be used for differentiating response groups in the resulting plot.</span></span>
<span><span class="co">#&gt; In xgx_stat_ci: </span></span>
<span><span class="co">#&gt;   The following aesthetics are different from response: PANEL</span></span>
<span><span class="co">#&gt;   These will be used to divide the data into different groups before calculating summary statistics on the response.</span></span>
<span><span class="co">#&gt; In xgx_stat_ci: </span></span>
<span><span class="co">#&gt;   The following aesthetics are identical to response: colour</span></span>
<span><span class="co">#&gt;   These will be used for differentiating response groups in the resulting plot.</span></span>
<span><span class="co">#&gt; In xgx_stat_ci: </span></span>
<span><span class="co">#&gt;   The following aesthetics are different from response: PANEL</span></span>
<span><span class="co">#&gt;   These will be used to divide the data into different groups before calculating summary statistics on the response.</span></span>
<span><span class="co">#&gt; Warning: Unknown or uninitialised column: `flipped_aes`.</span></span>
<span><span class="co">#&gt; Warning: Unknown or uninitialised column: `flipped_aes`.</span></span>
<span><span class="co">#&gt; Warning: Unknown or uninitialised column: `width`.</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-11-3.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="nonlinear-smoothing-e-g--emax-and-ordinal-response-smoothing">Nonlinear smoothing (e.g. Emax), and ordinal response smoothing<a class="anchor" aria-label="anchor" href="#nonlinear-smoothing-e-g--emax-and-ordinal-response-smoothing"></a>
</h3>
<p>The current ggplot2::geom_smooth does not allow for plotting
confidence bands for method = “nls”, as ggplot2 does not supply a
<code>predictdf</code> for an object of class <code>nls</code>, which
geom_smooth silently calls to calculate the ymin and ymax for the
confidence bands. The xgxr package includes a definition of
<code>predictdf.nls</code>, allowing for confidence bands for method =
“nls”.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123456</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Nsubj</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">Doses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">Ntot</span> <span class="op">&lt;-</span> <span class="va">Nsubj</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Doses</span><span class="op">)</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">14</span>,<span class="fl">30</span>,<span class="fl">60</span>,<span class="fl">90</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">Ntot</span><span class="op">)</span>,</span>
<span>                   DOSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">Doses</span>, <span class="va">Nsubj</span><span class="op">)</span>,</span>
<span>                   E0 <span class="op">=</span> <span class="fl">50</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">Ntot</span>, <span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>                   Emax <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">Ntot</span>, <span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>                   ED50 <span class="op">=</span> <span class="fl">50</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">Ntot</span>, <span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Response <span class="op">=</span> <span class="op">(</span><span class="va">E0</span> <span class="op">+</span> <span class="va">Emax</span><span class="op">*</span><span class="va">DOSE</span><span class="op">/</span><span class="op">(</span><span class="va">DOSE</span> <span class="op">+</span> <span class="va">ED50</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">Ntot</span>, <span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">Ntot</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span><span class="op">)</span>, Time <span class="op">=</span> <span class="va">times</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DOSE</span>, y <span class="op">=</span> <span class="va">Response</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="va">gg</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gg</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">gg</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"nlsLM"</span>, </span>
<span>                 formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">E0</span> <span class="op">+</span> <span class="va">Emax</span><span class="op">*</span><span class="va">x</span><span class="op">/</span><span class="op">(</span><span class="va">ED50</span> <span class="op">+</span> <span class="va">x</span><span class="op">)</span>,</span>
<span>                 method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>E0 <span class="op">=</span> <span class="fl">1</span>, ED50 <span class="op">=</span> <span class="fl">1</span>, Emax <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                    lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">0</span>, <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-12-2.png" width="672"></p>
<p>xgxr also includes an Emax smooth function called
<code>xgx_geom_smooth_emax</code> which utilizes the “nlsLM” method, and
silently calls the <code>predictdf.nls</code> defined by xgxr.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg</span> <span class="op">+</span> <span class="fu"><a href="../reference/xgx_stat_smooth.html">xgx_geom_smooth_emax</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in xgx_geom_smooth_emax(): Formula not specified.</span></span>
<span><span class="co">#&gt; Using default formula y ~ E0 + Emax*x/(ED50 + x),</span></span>
<span><span class="co">#&gt;             initializing E0, Emax, and ED50 to 1,</span></span>
<span><span class="co">#&gt;             and setting lower bound on ED50 to 0</span></span>
<span><span class="co">#&gt; Warning in xgx_stat_smooth(mapping = mapping, data = data, geom = geom, :</span></span>
<span><span class="co">#&gt; Ignoring unknown parameters: `n_boot`</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">gg</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/xgx_stat_smooth.html">xgx_geom_smooth_emax</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"ribbon"</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/xgx_stat_smooth.html">xgx_geom_smooth_emax</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"line"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in xgx_geom_smooth_emax(geom = "ribbon", color = "black", fill = NA, : Formula not specified.</span></span>
<span><span class="co">#&gt; Using default formula y ~ E0 + Emax*x/(ED50 + x),</span></span>
<span><span class="co">#&gt;             initializing E0, Emax, and ED50 to 1,</span></span>
<span><span class="co">#&gt;             and setting lower bound on ED50 to 0</span></span>
<span></span>
<span><span class="co">#&gt; Warning in xgx_geom_smooth_emax(geom = "ribbon", color = "black", fill = NA, : Ignoring unknown parameters: `n_boot`</span></span>
<span><span class="co">#&gt; Warning in xgx_geom_smooth_emax(geom = "line", color = "red"): Formula not specified.</span></span>
<span><span class="co">#&gt; Using default formula y ~ E0 + Emax*x/(ED50 + x),</span></span>
<span><span class="co">#&gt;             initializing E0, Emax, and ED50 to 1,</span></span>
<span><span class="co">#&gt;             and setting lower bound on ED50 to 0</span></span>
<span><span class="co">#&gt; Warning in xgx_stat_smooth(mapping = mapping, data = data, geom = geom, :</span></span>
<span><span class="co">#&gt; Ignoring unknown parameters: `n_boot`</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-13-2.png" width="672"></p>
<p>xgxr also modifies the stats method <code>predict.nls</code> for
<code>nls</code> objects in order to include confidence interval
prediction. Upon loading the xgxr package, the <code>predict</code>
method for class <code>nls</code> should be updated to the xgxr version,
and include functionality to supply confidence intervals. In order to
output the confidence intervals, be sure to specify
<code>interval = "confidence"</code>. The output will contain a “fit”
data.frame with values for “fit”, “lwr” and “upr” representing the
prediction and lower and upper confidence intervals.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">nlsLM</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Response</span> <span class="op">~</span> <span class="va">E0</span> <span class="op">+</span> <span class="va">Emax</span> <span class="op">*</span> <span class="va">DOSE</span> <span class="op">/</span> <span class="op">(</span><span class="va">ED50</span> <span class="op">+</span> <span class="va">DOSE</span><span class="op">)</span>,</span>
<span>             data <span class="op">=</span> <span class="va">dat1</span>,</span>
<span>             start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>E0 <span class="op">=</span> <span class="fl">1</span>, ED50 <span class="op">=</span> <span class="fl">1</span>, Emax <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                    lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">0</span>, <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod</span>,</span>
<span>            newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>DOSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; $fit</span></span>
<span><span class="co">#&gt; [1]  44.60368  99.70517 116.14226 128.68292 136.76043</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $se.fit</span></span>
<span><span class="co">#&gt; [1] 5.219335 4.289631 3.012974 2.969559 4.294878</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $df</span></span>
<span><span class="co">#&gt; [1] 247</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod</span>,</span>
<span>            newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>DOSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            se.fit <span class="op">=</span> <span class="cn">TRUE</span>, interval <span class="op">=</span> <span class="st">"confidence"</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt; $fit</span></span>
<span><span class="co">#&gt;         fit       lwr       upr</span></span>
<span><span class="co">#&gt; 1  44.60368  34.32360  54.88376</span></span>
<span><span class="co">#&gt; 2  99.70517  91.25625 108.15409</span></span>
<span><span class="co">#&gt; 3 116.14226 110.20786 122.07666</span></span>
<span><span class="co">#&gt; 4 128.68292 122.83404 134.53181</span></span>
<span><span class="co">#&gt; 5 136.76043 128.30118 145.21969</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $se.fit</span></span>
<span><span class="co">#&gt; [1] 5.219335 4.289631 3.012974 2.969559 4.294878</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $df</span></span>
<span><span class="co">#&gt; [1] 247</span></span></code></pre></div>
<p>xgxr also includes ordinal response smoothing as an option under the
<code>xgx_stat_smooth</code> function, indicated by
<code>method = "polr"</code>. This requires a dataset of x values and
response values, to be defined in the mapping. This method also allows
defining of color, fill, facet, linetype, etc. by the response category,
while preserving the ordinal response fit across these categories.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># example with ordinal data (method = "polr")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">120</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mild"</span>,<span class="st">"Moderate"</span>,<span class="st">"Severe"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                  covariate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>,<span class="st">"Female"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>y <span class="op">=</span> <span class="op">(</span><span class="fl">50</span> <span class="op">+</span> <span class="fl">20</span><span class="op">*</span><span class="va">x</span><span class="op">/</span><span class="op">(</span><span class="fl">200</span> <span class="op">+</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># example coloring by the response categories</span></span>
<span><span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/xgx_stat_smooth.html">xgx_stat_smooth</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, response <span class="op">=</span> <span class="va">response</span>,</span>
<span>                                         colour <span class="op">=</span> <span class="va">response</span>, fill <span class="op">=</span> <span class="va">response</span><span class="op">)</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"polr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula 'response ~ x'</span></span>
<span><span class="co">#&gt; In xgx_stat_smooth: </span></span>
<span><span class="co">#&gt;   The following aesthetics are identical to response: PANEL, colour, fill</span></span>
<span><span class="co">#&gt;   These will be used for differentiating response groups in the resulting plot.</span></span>
<span><span class="co">#&gt; In xgx_stat_smooth: </span></span>
<span><span class="co">#&gt;   response should be a factor, converting to factor using as.factor(response) with default levels</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># example faceting by the response categories, coloring by a different covariate</span></span>
<span><span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/xgx_stat_smooth.html">xgx_stat_smooth</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, response <span class="op">=</span> <span class="va">response</span>,</span>
<span>                                         colour <span class="op">=</span> <span class="va">covariate</span>, fill <span class="op">=</span> <span class="va">covariate</span><span class="op">)</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"polr"</span>, level <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">response</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula 'response ~ x'</span></span>
<span><span class="co">#&gt; In xgx_stat_smooth: </span></span>
<span><span class="co">#&gt;   The following aesthetics are identical to response: PANEL</span></span>
<span><span class="co">#&gt;   These will be used for differentiating response groups in the resulting plot.</span></span>
<span><span class="co">#&gt; In xgx_stat_smooth: </span></span>
<span><span class="co">#&gt;   The following aesthetics are different from response: colour, fill</span></span>
<span><span class="co">#&gt;   These will be used to divide the data into different groups before calculating summary statistics on the response.</span></span>
<span><span class="co">#&gt; In xgx_stat_smooth: </span></span>
<span><span class="co">#&gt;   response should be a factor, converting to factor using as.factor(response) with default levels</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-15-2.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="nice-log-scale">Nice log scale<a class="anchor" aria-label="anchor" href="#nice-log-scale"></a>
</h3>
<p>This version of the log scale function shows the tick marks between
the major breaks (i.e. at 1, 2, 3, … 10, instead of just 1 and 10). It
also uses <span class="math display">\[10^x\]</span> notation when the
labels are base 10 and are very small or very large (&lt;.001 or
&gt;9999)</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/xgx_scale_x_log10.html">xgx_scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous x-axis</span></span>
<span><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="reverse-log-transform">Reverse log transform<a class="anchor" aria-label="anchor" href="#reverse-log-transform"></a>
</h3>
<p>This transform is useful for plotting data on a percentage scale that
can approach 100% (such as receptor occupancy data).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conc</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ec50</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>concentration <span class="op">=</span> <span class="va">conc</span>, </span>
<span>                  bound_receptor <span class="op">=</span> <span class="fl">1</span> <span class="op">*</span> <span class="va">conc</span> <span class="op">/</span> <span class="op">(</span><span class="va">conc</span> <span class="op">+</span> <span class="va">ec50</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">concentration</span>, y <span class="op">=</span> <span class="va">bound_receptor</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/xgx_scale_x_log10.html">xgx_scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/xgx_scale_y_reverselog10.html">xgx_scale_y_reverselog10</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bound_receptor</span>, y <span class="op">=</span> <span class="va">concentration</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/xgx_scale_x_reverselog10.html">xgx_scale_x_reverselog10</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">gy</span>, <span class="va">gx</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="nice-scale-for-percent-change-data">Nice scale for percent change data<a class="anchor" aria-label="anchor" href="#nice-scale-for-percent-change-data"></a>
</h3>
<p>This transform is useful for plotting percent change from baseline
data. Percent change data can range from -100% to +Inf%, and depending
on the range of the data, a linear scale can lose the desired
resolution. This transform plots percent change data on a scale of
log10(PCHG + 100%), similar to a log scale of ratio to baseline.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">Nsubj</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">Doses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">Ntot</span> <span class="op">&lt;-</span> <span class="va">Nsubj</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Doses</span><span class="op">)</span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">14</span>,<span class="fl">30</span>,<span class="fl">60</span>,<span class="fl">90</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">Ntot</span><span class="op">)</span>,</span>
<span>                   DOSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">Doses</span>, <span class="va">Nsubj</span><span class="op">)</span>,</span>
<span>                   PD0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">Ntot</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                   Kout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">Ntot</span>,<span class="op">-</span><span class="fl">2</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   Imax <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                   ED50 <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>PDSS <span class="op">=</span> <span class="va">PD0</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">Imax</span><span class="op">*</span><span class="va">DOSE</span><span class="op">/</span><span class="op">(</span><span class="va">DOSE</span> <span class="op">+</span> <span class="va">ED50</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">Ntot</span>, <span class="fl">0.05</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">Ntot</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span><span class="op">)</span>, Time <span class="op">=</span> <span class="va">times</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>PD <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">PD0</span> <span class="op">-</span> <span class="va">PDSS</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">Kout</span><span class="op">*</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">PDSS</span><span class="op">)</span>, </span>
<span>                PCHG <span class="op">=</span> <span class="op">(</span><span class="va">PD</span> <span class="op">-</span> <span class="va">PD0</span><span class="op">)</span><span class="op">/</span><span class="va">PD0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">90</span><span class="op">)</span>, </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DOSE</span>, y <span class="op">=</span> <span class="va">PCHG</span>, group <span class="op">=</span> <span class="va">DOSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/xgx_theme.html">xgx_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/xgx_scale_y_percentchangelog10.html">xgx_scale_y_percentchangelog10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Percent Change from Baseline"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Dose (mg)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat1</span>, </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">PCHG</span>, group <span class="op">=</span> <span class="va">ID</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/xgx_theme.html">xgx_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/xgx_scale_y_percentchangelog10.html">xgx_scale_y_percentchangelog10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Dose (mg)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Percent Change from Baseline"</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-18-2.png" width="672"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">Ntot</span><span class="op">)</span>,</span>
<span>                  DOSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">Doses</span>, <span class="va">Nsubj</span><span class="op">)</span>,</span>
<span>                  PD0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">Ntot</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                  Kout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">Ntot</span>,<span class="op">-</span><span class="fl">2</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  Emax <span class="op">=</span> <span class="fl">50</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">Ntot</span>, <span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>                  ED50 <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>PDSS <span class="op">=</span> <span class="va">PD0</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Emax</span><span class="op">*</span><span class="va">DOSE</span><span class="op">/</span><span class="op">(</span><span class="va">DOSE</span> <span class="op">+</span> <span class="va">ED50</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">Ntot</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">Ntot</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span><span class="op">)</span>, Time <span class="op">=</span> <span class="va">times</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>PD <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">PD0</span> <span class="op">-</span> <span class="va">PDSS</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">Kout</span><span class="op">*</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">PDSS</span><span class="op">)</span>, </span>
<span>                PCHG <span class="op">=</span> <span class="op">(</span><span class="va">PD</span> <span class="op">-</span> <span class="va">PD0</span><span class="op">)</span><span class="op">/</span><span class="va">PD0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat2</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DOSE</span>, y <span class="op">=</span> <span class="va">PCHG</span>, group <span class="op">=</span> <span class="va">DOSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/xgx_theme.html">xgx_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/xgx_scale_y_percentchangelog10.html">xgx_scale_y_percentchangelog10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Percent Change from Baseline"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Dose (mg)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-18-3.png" width="672"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat2</span>, </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">PCHG</span>, group <span class="op">=</span> <span class="va">ID</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/xgx_theme.html">xgx_theme</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/xgx_scale_y_percentchangelog10.html">xgx_scale_y_percentchangelog10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Dose (mg)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Percent Change from Baseline"</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-18-4.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="scaling-x-axis-as-a-time-scale">Scaling x-axis as a time scale<a class="anchor" aria-label="anchor" href="#scaling-x-axis-as-a-time-scale"></a>
</h3>
<p>For time, it’s often good for the x ticks to be spaced in a
particular way. For instance, for hours, subdividing in increments by
24, 12, 6, and 3 hours can make more sense than by 10 or 100. Similarly
for days, increments of 7 or 28 days are preferred over 5 or 10 days.
<code>xgx_scale_x_time_units</code> allows for this, where it is the
input and output units.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, y <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xgx_plot.html">xgx_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span>units_dataset <span class="op">=</span> <span class="st">"hours"</span>, units_plot <span class="op">=</span> <span class="st">"hours"</span><span class="op">)</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span>units_dataset <span class="op">=</span> <span class="st">"hours"</span>, units_plot <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span></span>
<span><span class="va">g3</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span>units_dataset <span class="op">=</span> <span class="st">"hours"</span>, units_plot <span class="op">=</span> <span class="st">"weeks"</span><span class="op">)</span></span>
<span><span class="va">g4</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span>units_dataset <span class="op">=</span> <span class="st">"hours"</span>, units_plot <span class="op">=</span> <span class="st">"months"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, <span class="va">g3</span>, <span class="va">g4</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="xgxr_overview_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Andrew Stein, Alison Margolskee, Fariba Khanshan, Konstantin Krismer, Novartis Pharma AG.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
