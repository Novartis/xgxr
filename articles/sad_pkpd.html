<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PKPD Single Ascending Dose example • xgxr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="PKPD Single Ascending Dose example">
<meta property="og:description" content="xgxr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xgxr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sad_pkpd.html">PKPD Single Ascending Dose example</a>
    </li>
    <li>
      <a href="../articles/theoph.html">PK Exploration with nlmixr dataset</a>
    </li>
    <li>
      <a href="../articles/xgxr_overview.html">xgxr Overview</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Novartis/xgxr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sad_pkpd_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>PKPD Single Ascending Dose example</h1>
                        <h4 class="author">Fariba Khanshan, Andrew Stein, Alison Margolskee</h4>
            
            <h4 class="date">2021-07-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Novartis/xgxr/blob/master/vignettes/sad_pkpd.Rmd"><code>vignettes/sad_pkpd.Rmd</code></a></small>
      <div class="hidden name"><code>sad_pkpd.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>This document contains exploratory plots for single ascending dose PK and PD data as well as the R code that generates these graphs. The plots presented here are based on simulated data.</p>
</div>
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://opensource.nibr.com/xgx/">xgxr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>

<span class="co"># flag for labeling figures as draft</span>
<span class="va">status</span> <span class="op">&lt;-</span> <span class="st">"DRAFT"</span>
 
<span class="co"># ggplot settings</span>
<span class="fu"><a href="../reference/xgx_theme_set.html">xgx_theme_set</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="load-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#load-dataset" class="anchor"></a>Load Dataset</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pkpd_data</span> <span class="op">&lt;-</span> <span class="va">case1_pkpd</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>,<span class="op">-</span><span class="va">IPRED</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>TRTACT_low2high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">TRTACT</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">TRTACT</span><span class="op">)</span><span class="op">)</span>,
         TRTACT_high2low <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">TRTACT</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">TRTACT</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
         DAY_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Day"</span>, <span class="va">PROFDAY</span><span class="op">)</span>,
         DAY_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">DAY_label</span> <span class="op">==</span> <span class="st">"Day 0"</span>,<span class="st">"Baseline"</span>,<span class="va">DAY_label</span><span class="op">)</span><span class="op">)</span>
 
<span class="va">LOQ</span> <span class="op">=</span> <span class="fl">0.05</span> <span class="co">#ng/ml</span>
<span class="va">dose_max</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">pkpd_data</span><span class="op">$</span><span class="va">DOSE</span><span class="op">)</span><span class="op">)</span>
<span class="va">pk_data</span> <span class="op">&lt;-</span> <span class="va">pkpd_data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CMT</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>LIDVNORM <span class="op">=</span> <span class="va">LIDV</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">)</span><span class="op">)</span>

<span class="va">pk_data_cycle1</span> <span class="op">&lt;-</span> <span class="va">pk_data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CYCLE</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>
 
<span class="va">pd_data</span> <span class="op">&lt;-</span> <span class="va">pkpd_data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CMT</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span>

<span class="va">pd_data_baseline_day85</span> <span class="op">&lt;-</span> <span class="va">pkpd_data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CMT</span> <span class="op">==</span> <span class="fl">3</span>,
         <span class="va">DAY_label</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Baseline"</span>, <span class="st">"Day 85"</span><span class="op">)</span><span class="op">)</span>

<span class="va">pk_vs_pd_data</span> <span class="op">&lt;-</span> <span class="va">pkpd_data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">LIDV</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">EVENTU</span>,<span class="va">NAME</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html">spread</a></span><span class="op">(</span><span class="va">CMT</span>,<span class="va">LIDV</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>Concentration <span class="op">=</span> <span class="va">`2`</span>, Response <span class="op">=</span> <span class="va">`3`</span><span class="op">)</span>

<span class="va">NCA</span> <span class="op">&lt;-</span> <span class="va">pk_data_cycle1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">DOSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">LIDV</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>AUC_last <span class="op">=</span> <span class="fu">caTools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caTools/man/trapz.html">trapz</a></span><span class="op">(</span><span class="va">TIME</span>, <span class="va">LIDV</span><span class="op">)</span>,
            Cmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">LIDV</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span><span class="va">PARAM</span>,<span class="va">VALUE</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">DOSE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>VALUE_NORM <span class="op">=</span> <span class="va">VALUE</span> <span class="op">/</span> <span class="va">DOSE</span><span class="op">)</span>

<span class="va">AUC_last</span> <span class="op">&lt;-</span> <span class="va">NCA</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">PARAM</span> <span class="op">==</span> <span class="st">"AUC_last"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>AUC_last <span class="op">=</span> <span class="va">VALUE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">DOSE</span>,<span class="va">PARAM</span>,<span class="va">VALUE_NORM</span><span class="op">)</span><span class="op">)</span>

<span class="va">pk_vs_pd_data_day85</span> <span class="op">&lt;-</span> <span class="va">pk_vs_pd_data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">DAY_label</span> <span class="op">==</span> <span class="st">"Day 85"</span>,
         <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Concentration</span><span class="op">)</span>,
         <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Response</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">AUC_last</span><span class="op">)</span>


<span class="va">time_units_dataset</span> <span class="op">&lt;-</span> <span class="st">"hours"</span>
<span class="va">time_units_plot</span>    <span class="op">&lt;-</span> <span class="st">"days"</span>
<span class="va">trtact_label</span>       <span class="op">&lt;-</span> <span class="st">"Dose"</span>
<span class="va">dose_label</span>         <span class="op">&lt;-</span> <span class="st">"Dose (mg)"</span>
<span class="va">conc_label</span>         <span class="op">&lt;-</span> <span class="st">"Concentration (ng/ml)"</span> 
<span class="va">auc_label</span>          <span class="op">&lt;-</span> <span class="st">"AUCtau (h.(ng/ml))"</span>
<span class="va">concnorm_label</span>     <span class="op">&lt;-</span> <span class="st">"Normalized Concentration (ng/ml)/mg"</span>
<span class="va">sex_label</span>          <span class="op">&lt;-</span> <span class="st">"Sex"</span>
<span class="va">w100_label</span>         <span class="op">&lt;-</span> <span class="st">"WEIGHTB&gt;100"</span>
<span class="va">pd_label</span>           <span class="op">&lt;-</span> <span class="st">"FEV1 (mL)"</span>
<span class="va">cens_label</span>         <span class="op">&lt;-</span> <span class="st">"Censored"</span></code></pre></div>
</div>
<div id="provide-an-overview-of-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#provide-an-overview-of-the-data" class="anchor"></a>Provide an overview of the data</h2>
<p>Summarize the data in a way that is easy to visualize the general trend of PK over time and between doses. Using summary statistics can be helpful, e.g.  Mean +/- SE, or median, 5th &amp; 95th percentiles. Consider either coloring by dose or faceting by dose. Depending on the amount of data one graph may be better than the other.</p>
<p>When looking at summaries of PK over time, there are several things to observe. Note the number of doses and number of time points or sampling schedule. Observe the overall shape of the average profiles. What is the average Cmax per dose? Tmax? Does the elimination phase appear to be parallel across the different doses? Is there separation between the profiles for different doses? Can you make a visual estimate of the number of compartments that would be needed in a PK model?</p>
<div id="concentration-over-time-colored-by-dose-mean---95-ci" class="section level3">
<h3 class="hasAnchor">
<a href="#concentration-over-time-colored-by-dose-mean---95-ci" class="anchor"></a>Concentration over time, colored by Dose, mean +/- 95% CI</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pk_data_cycle1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x     <span class="op">=</span> <span class="va">NOMTIME</span>,
                                  y     <span class="op">=</span> <span class="va">LIDV</span>,
                                  group <span class="op">=</span> <span class="va">DOSE</span>,
                                  color <span class="op">=</span> <span class="va">TRTACT_high2low</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_geom_ci.html">xgx_geom_ci</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span>units_dataset <span class="op">=</span> <span class="va">time_units_dataset</span>, units_plot <span class="op">=</span> <span class="va">time_units_plot</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">conc_label</span>, color <span class="op">=</span> <span class="va">trtact_label</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_annotate_status.html">xgx_annotate_status</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span></code></pre></div>
<p><img src="sad_pkpd_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
<div id="concentration-over-time-faceted-by-dose-mean---95-ci-overlaid-on-gray-spaghetti-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#concentration-over-time-faceted-by-dose-mean---95-ci-overlaid-on-gray-spaghetti-plots" class="anchor"></a>Concentration over time, faceted by Dose, mean +/- 95% CI, overlaid on gray spaghetti plots</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pk_data_cycle1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TIME</span>, y <span class="op">=</span> <span class="va">LIDV</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">ID</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey50"</span>, size <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">CENS</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">CENS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey50"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_geom_ci.html">xgx_geom_ci</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NOMTIME</span>, color <span class="op">=</span> <span class="cn">NULL</span>, group <span class="op">=</span> <span class="cn">NULL</span>, shape <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>, conf_level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span>units_dataset <span class="op">=</span> <span class="va">time_units_dataset</span>, units_plot <span class="op">=</span> <span class="va">time_units_plot</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">conc_label</span>, color <span class="op">=</span> <span class="va">trtact_label</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">TRTACT_low2high</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_annotate_status.html">xgx_annotate_status</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span></code></pre></div>
<p><img src="sad_pkpd_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
</div>
</div>
<div id="assess-the-dose-linearity-of-exposure" class="section level2">
<h2 class="hasAnchor">
<a href="#assess-the-dose-linearity-of-exposure" class="anchor"></a>Assess the dose linearity of exposure</h2>
<div id="dose-normalized-concentration-over-time-colored-by-dose-mean---95-ci" class="section level3">
<h3 class="hasAnchor">
<a href="#dose-normalized-concentration-over-time-colored-by-dose-mean---95-ci" class="anchor"></a>Dose Normalized Concentration over time, colored by Dose, mean +/- 95% CI</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pk_data_cycle1</span>,
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NOMTIME</span>,
           y <span class="op">=</span> <span class="va">LIDVNORM</span>,
           group <span class="op">=</span> <span class="va">DOSE</span>,
           color <span class="op">=</span> <span class="va">TRTACT_high2low</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_geom_ci.html">xgx_geom_ci</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">0.95</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span>units_dataset <span class="op">=</span> <span class="va">time_units_dataset</span>, units_plot <span class="op">=</span> <span class="va">time_units_plot</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">concnorm_label</span>, color <span class="op">=</span> <span class="va">trtact_label</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_annotate_status.html">xgx_annotate_status</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span></code></pre></div>
<p><img src="sad_pkpd_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div id="nca-of-dose-normalized-auc-and-cmax-vs-dose" class="section level3">
<h3 class="hasAnchor">
<a href="#nca-of-dose-normalized-auc-and-cmax-vs-dose" class="anchor"></a>NCA of dose normalized AUC and Cmax vs Dose</h3>
<p>Observe the dose normalized AUC and Cmax over different doses. Does the relationship appear to be constant across doses or do some doses stand out from the rest? Can you think of reasons why some would stand out? For example, the lowest dose may have dose normalized AUC much higher than the rest, could this be due to BLQ observations? If the highest doses have dose normalized AUC much higher than the others, could this be due to nonlinear clearance, with clearance saturating at higher doses? If the highest doses have dose normalized AUC much lower than the others, could there be saturation of bioavailability, reaching the maximum absorbable dose?</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">NCA</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DOSE</span>, y <span class="op">=</span> <span class="va">VALUE_NORM</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">DOSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PARAM</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dose_label</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_annotate_status.html">xgx_annotate_status</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span></code></pre></div>
<p><img src="sad_pkpd_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">NCA</span><span class="op">[</span><span class="op">!</span><span class="va">NCA</span><span class="op">$</span><span class="va">DOSE</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">NCA</span><span class="op">$</span><span class="va">DOSE</span> <span class="op">==</span> <span class="fl">10</span> , <span class="op">]</span>,
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DOSE</span>, y <span class="op">=</span> <span class="va">VALUE_NORM</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">DOSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PARAM</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dose_label</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_annotate_status.html">xgx_annotate_status</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span></code></pre></div>
<p><img src="sad_pkpd_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
</div>
<div id="explore-covariate-effects-on-pk" class="section level2">
<h2 class="hasAnchor">
<a href="#explore-covariate-effects-on-pk" class="anchor"></a>Explore covariate effects on PK</h2>
<div id="concentration-over-time-colored-by-categorical-covariate-mean---95-ci" class="section level3">
<h3 class="hasAnchor">
<a href="#concentration-over-time-colored-by-categorical-covariate-mean---95-ci" class="anchor"></a>Concentration over time, colored by categorical covariate, mean +/- 95% CI</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pk_data_cycle1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NOMTIME</span>,
                                   y <span class="op">=</span> <span class="va">LIDV</span>,
                                   group <span class="op">=</span> <span class="va">WEIGHTB</span> <span class="op">&gt;</span> <span class="fl">100</span>,
                                   color <span class="op">=</span> <span class="va">WEIGHTB</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="../reference/xgx_geom_ci.html">xgx_geom_ci</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span>units_dataset <span class="op">=</span> <span class="va">time_units_dataset</span>, units_plot <span class="op">=</span> <span class="va">time_units_plot</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">DOSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">conc_label</span>, color <span class="op">=</span> <span class="va">w100_label</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_annotate_status.html">xgx_annotate_status</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span></code></pre></div>
<p><img src="sad_pkpd_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</div>
</div>
<div id="pd-marker-over-time-colored-by-dose-mean-95-ci-percentiles-by-nominal-time" class="section level2">
<h2 class="hasAnchor">
<a href="#pd-marker-over-time-colored-by-dose-mean-95-ci-percentiles-by-nominal-time" class="anchor"></a>PD marker over time, colored by Dose, mean (95% CI) percentiles by nominal time</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pd_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x     <span class="op">=</span> <span class="va">NOMTIME</span>,
                           y     <span class="op">=</span> <span class="va">LIDV</span>,
                           group <span class="op">=</span> <span class="va">DOSE</span>,
                           color <span class="op">=</span> <span class="va">TRTACT_high2low</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_geom_ci.html">xgx_geom_ci</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span>units_dataset <span class="op">=</span> <span class="va">time_units_dataset</span>, units_plot <span class="op">=</span> <span class="va">time_units_plot</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pd_label</span>, color <span class="op">=</span> <span class="va">trtact_label</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="../reference/xgx_annotate_status.html">xgx_annotate_status</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span></code></pre></div>
<p><img src="sad_pkpd_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
<div id="pd-marker-over-time-faceted-by-dose-dots-lines-grouped-by-individuals" class="section level2">
<h2 class="hasAnchor">
<a href="#pd-marker-over-time-faceted-by-dose-dots-lines-grouped-by-individuals" class="anchor"></a>PD marker over time, faceted by Dose, dots &amp; lines grouped by individuals</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pd_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NOMTIME</span>, y <span class="op">=</span> <span class="va">LIDV</span>, group <span class="op">=</span> <span class="va">ID</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span>units_dataset <span class="op">=</span> <span class="va">time_units_dataset</span>, units_plot <span class="op">=</span> <span class="va">time_units_plot</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">TRTACT_low2high</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pd_label</span>, color <span class="op">=</span> <span class="va">trtact_label</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_annotate_status.html">xgx_annotate_status</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span></code></pre></div>
<p><img src="sad_pkpd_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</div>
<div id="explore-dose-response-relationship" class="section level2">
<h2 class="hasAnchor">
<a href="#explore-dose-response-relationship" class="anchor"></a>Explore Dose-Response Relationship</h2>
<p>One of the key questions when looking at PD markers is to determine if there is a dose-response relationship, and if there is, what dose is necessary to achieve the desired effect? Simple dose-response plots can give insight into these questions.</p>
<div id="pd-marker-by-dose-for-endpoint-of-interest-mean-95-ci-by-dose" class="section level3">
<h3 class="hasAnchor">
<a href="#pd-marker-by-dose-for-endpoint-of-interest-mean-95-ci-by-dose" class="anchor"></a>PD marker by Dose, for endpoint of interest, mean (95% CI) by Dose</h3>
<p>Plot PD marker against dose. Using summary statistics can be helpful, e.g.  Mean +/- SE, or median, 5th &amp; 95th percentiles.</p>
<p>Here are some questions to ask yourself when looking at Dose-Response plots: Do you see any relationship? Does response increase (decrease) with increasing dose? Are you able to detect a plateau or Emax (Emin) on the effect? If so, around what dose does this occur?</p>
<p>Warning: Even if you don’t see an Emax, that doesn’t mean there isn’t one. Be very careful about using linear models for Dose-Response relationships. Extrapolation outside of the observed dose range could indicate a higher dose is always better (even if it isn’t).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pd_data_baseline_day85</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DOSE</span>,
                                          y <span class="op">=</span> <span class="va">LIDV</span>,
                                          group <span class="op">=</span> <span class="va">DOSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_geom_ci.html">xgx_geom_ci</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">DAY_label</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dose_label</span>, y <span class="op">=</span> <span class="va">pd_label</span>, color <span class="op">=</span> <span class="va">trtact_label</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_annotate_status.html">xgx_annotate_status</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span></code></pre></div>
<p><img src="sad_pkpd_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
</div>
<div id="pd-marker-by-dose-faceted-by-visit-mean-95-ci-by-dose" class="section level3">
<h3 class="hasAnchor">
<a href="#pd-marker-by-dose-faceted-by-visit-mean-95-ci-by-dose" class="anchor"></a>PD marker by Dose, faceted by visit, mean (95% CI) by Dose</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pd_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DOSE</span>, y <span class="op">=</span> <span class="va">LIDV</span>, group <span class="op">=</span> <span class="va">DOSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_geom_ci.html">xgx_geom_ci</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">DAY_label</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dose_label</span>, y <span class="op">=</span> <span class="va">pd_label</span>, color <span class="op">=</span> <span class="va">trtact_label</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_annotate_status.html">xgx_annotate_status</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span></code></pre></div>
<p><img src="sad_pkpd_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
</div>
<div id="explore-covariate-effects-on-dose-response-relationship" class="section level3">
<h3 class="hasAnchor">
<a href="#explore-covariate-effects-on-dose-response-relationship" class="anchor"></a>Explore covariate effects on Dose-Response relationship</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pd_data_baseline_day85</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DOSE</span>,
                                          y <span class="op">=</span> <span class="va">LIDV</span>,
                                          group <span class="op">=</span> <span class="va">WEIGHTB</span> <span class="op">&gt;</span> <span class="fl">100</span>,
                                          color <span class="op">=</span> <span class="va">WEIGHTB</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_geom_ci.html">xgx_geom_ci</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">DAY_label</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dose_label</span>, y <span class="op">=</span> <span class="va">pd_label</span>, color <span class="op">=</span> <span class="va">w100_label</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_annotate_status.html">xgx_annotate_status</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span></code></pre></div>
<p><img src="sad_pkpd_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
</div>
<div id="explore-exposure-response-relationship" class="section level2">
<h2 class="hasAnchor">
<a href="#explore-exposure-response-relationship" class="anchor"></a>Explore Exposure-Response Relationship</h2>
<p>Plot PD marker against concentration. Do you see any relationship? Does response increase (decrease) with increasing dose? Are you able to detect a plateau or Emax (Emin) on the effect?</p>
<p>Warning: Even if you don’t see an Emax, that doesn’t mean there isn’t one. Be very careful about using linear models for Dose-Response or Exposure-Response relationships. Extrapolation outside of the observed dose range could indicate a higher dose is always better (even if it isn’t).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pk_vs_pd_data_day85</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Concentration</span>, y <span class="op">=</span> <span class="va">Response</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">TRTACT_high2low</span>, shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">CENS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>,shape<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_x_log10.html">xgx_scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">conc_label</span>, y <span class="op">=</span> <span class="va">pd_label</span>, color <span class="op">=</span> <span class="va">trtact_label</span>, shape <span class="op">=</span> <span class="va">cens_label</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_annotate_status.html">xgx_annotate_status</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></code></pre></div>
<p><img src="sad_pkpd_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<p>Plotting AUC vs response instead of concentration vs response may make more sense in some situations. For example, when there is a large delay between PK and PD it would be difficult to relate the time-varying concentration with the response. If rich sampling is only done at a particular point in the study, e.g. at steady state, then the AUC calculated on the rich profile could be used as the exposure variable for a number of PD visits. If PK samples are scarce, average Cmin could also be used as the exposure metric.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gAUC</span> <span class="op">=</span> <span class="va">g</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">AUC_last</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="va">auc_label</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">gAUC</span><span class="op">)</span></code></pre></div>
<p><img src="sad_pkpd_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
</div>
<div id="r-session-info" class="section level2">
<h2 class="hasAnchor">
<a href="#r-session-info" class="anchor"></a>R Session Info</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R version 4.1.0 (2021-05-18)</span>
<span class="co">#&gt; Platform: x86_64-apple-darwin17.0 (64-bit)</span>
<span class="co">#&gt; Running under: macOS Catalina 10.15.7</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib</span>
<span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt; [1] tidyr_1.1.3   dplyr_1.0.7   ggplot2_3.3.5 xgxr_1.1.1   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] nlme_3.1-152        bitops_1.0-7        fs_1.5.0           </span>
<span class="co">#&gt;  [4] RColorBrewer_1.1-2  rprojroot_2.0.2     Deriv_4.1.3        </span>
<span class="co">#&gt;  [7] tools_4.1.0         backports_1.2.1     utf8_1.2.1         </span>
<span class="co">#&gt; [10] R6_2.5.0            rpart_4.1-15        Hmisc_4.5-0        </span>
<span class="co">#&gt; [13] mgcv_1.8-35         colorspace_2.0-2    nnet_7.3-16        </span>
<span class="co">#&gt; [16] withr_2.4.2         tidyselect_1.1.1    gridExtra_2.3      </span>
<span class="co">#&gt; [19] Exact_2.1           compiler_4.1.0      textshaping_0.3.5  </span>
<span class="co">#&gt; [22] htmlTable_2.2.1     binom_1.1-1         expm_0.999-6       </span>
<span class="co">#&gt; [25] desc_1.3.0          labeling_0.4.2      caTools_1.18.2     </span>
<span class="co">#&gt; [28] scales_1.1.1        checkmate_2.0.0     mvtnorm_1.1-2      </span>
<span class="co">#&gt; [31] readr_1.4.0         proxy_0.4-26        pkgdown_1.6.1      </span>
<span class="co">#&gt; [34] systemfonts_1.0.2   stringr_1.4.0       digest_0.6.27      </span>
<span class="co">#&gt; [37] foreign_0.8-81      rmarkdown_2.9       base64enc_0.1-3    </span>
<span class="co">#&gt; [40] jpeg_0.1-8.1        pkgconfig_2.0.3     htmltools_0.5.1.1  </span>
<span class="co">#&gt; [43] fastmap_1.1.0       highr_0.9           htmlwidgets_1.5.3  </span>
<span class="co">#&gt; [46] rlang_0.4.11        rstudioapi_0.13     generics_0.1.0     </span>
<span class="co">#&gt; [49] farver_2.1.0        RCurl_1.98-1.3      magrittr_2.0.1     </span>
<span class="co">#&gt; [52] Formula_1.2-4       Matrix_1.3-3        Rcpp_1.0.6         </span>
<span class="co">#&gt; [55] DescTools_0.99.42   munsell_0.5.0       fansi_0.5.0        </span>
<span class="co">#&gt; [58] lifecycle_1.0.0     stringi_1.6.2       yaml_2.2.1         </span>
<span class="co">#&gt; [61] MASS_7.3-54         rootSolve_1.8.2.1   grid_4.1.0         </span>
<span class="co">#&gt; [64] crayon_1.4.1        lmom_2.8            lattice_0.20-44    </span>
<span class="co">#&gt; [67] splines_4.1.0       pander_0.6.4        hms_1.1.0          </span>
<span class="co">#&gt; [70] knitr_1.33          pillar_1.6.1        boot_1.3-28        </span>
<span class="co">#&gt; [73] gld_2.6.2           glue_1.4.2          evaluate_0.14      </span>
<span class="co">#&gt; [76] latticeExtra_0.6-29 data.table_1.14.0   png_0.1-7          </span>
<span class="co">#&gt; [79] vctrs_0.3.8         gtable_0.3.0        purrr_0.3.4        </span>
<span class="co">#&gt; [82] assertthat_0.2.1    cachem_1.0.5        xfun_0.24          </span>
<span class="co">#&gt; [85] e1071_1.7-7         ragg_1.1.3          class_7.3-19       </span>
<span class="co">#&gt; [88] survival_3.2-11     minpack.lm_1.2-1    tibble_3.1.2       </span>
<span class="co">#&gt; [91] memoise_2.0.0       cluster_2.1.2       ellipsis_0.3.2</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Andrew Stein, Alison Margolskee, Fariba Khanshan, Konstantin Krismer, Novartis Pharma AG.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
