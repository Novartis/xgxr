<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PK Exploration with nlmixr dataset • xgxr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="PK Exploration with nlmixr dataset">
<meta property="og:description" content="xgxr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xgxr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sad_pkpd.html">PKPD Single Ascending Dose example</a>
    </li>
    <li>
      <a href="../articles/theoph.html">PK Exploration with nlmixr dataset</a>
    </li>
    <li>
      <a href="../articles/xgxr_overview.html">xgxr Overview</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="theoph_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>PK Exploration with nlmixr dataset</h1>
                        <h4 class="author">Andrew Stein, Fariba Khanshan, Alison Margolskee</h4>
            
            <h4 class="date">2021-02-04</h4>
      
      
      <div class="hidden name"><code>theoph.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>This document provides a template for exploring Single or Multiple Ascending Dose PK data.</p>
</div>
<div id="load-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#load-packages" class="anchor"></a>Load Packages</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://opensource.nibr.com/xgx/">xgxr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>

<span class="co"># setting ggplot theme</span>
<span class="fu"><a href="../reference/xgx_theme_set.html">xgx_theme_set</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="load-the-dataset-and-assign-columns--take-subsets-of-data-that-are-needed" class="section level2">
<h2 class="hasAnchor">
<a href="#load-the-dataset-and-assign-columns--take-subsets-of-data-that-are-needed" class="anchor"></a>Load the dataset and assign columns. Take subsets of data that are needed</h2>
<p>Multiplying dose by weight to get a mg dosing.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># units of dataset</span>
<span class="va">time_units_dataset</span> <span class="op">&lt;-</span> <span class="st">"hours"</span>
<span class="va">time_units_plot</span>    <span class="op">&lt;-</span> <span class="st">"days"</span>
<span class="va">dose_label</span>         <span class="op">&lt;-</span> <span class="st">"Dose (mg)"</span>
<span class="va">conc_label</span>         <span class="op">&lt;-</span> <span class="st">"Concentration (ug/ml)"</span>  
<span class="va">concnorm_label</span>     <span class="op">&lt;-</span> <span class="st">"Normalized Concentration (ug/ml)/mg"</span>
  
<span class="co"># covariates in the dataset</span>
<span class="va">covariates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"WT"</span><span class="op">)</span>
  
<span class="co"># load dataset </span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">nlmixr_theo_sd</span>
  
<span class="co"># make sure that the necessary columns are assigned</span>
<span class="co"># five columns are required: TIME, LIDV, CMT, DOSE, DOSEREG</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span>   <span class="co">#ID column</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>TIME <span class="op">=</span> <span class="va">TIME</span>,     <span class="co">#TIME column name </span>
         NOMTIME <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">TIME</span>,
                                  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">1.5</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">10.5</span>, <span class="fl">15</span>, <span class="cn">Inf</span><span class="op">)</span>, 
                                  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">12</span>, <span class="fl">24</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
         EVID    <span class="op">=</span> <span class="va">EVID</span>,                     <span class="co"># EVENT ID &gt;=1 is dose, 0 otherwise</span>
         CYCLE   <span class="op">=</span> <span class="fl">1</span>,                        <span class="co"># CYCLE of PK data </span>
         LIDV    <span class="op">=</span> <span class="va">DV</span>,                       <span class="co"># DEPENDENT VARIABLE column name</span>
         CENS    <span class="op">=</span> <span class="fl">0</span>,                        <span class="co"># CENSORING column name</span>
         CMT     <span class="op">=</span> <span class="va">CMT</span>,                      <span class="co"># COMPARTMENT column here (e.g. CMT or YTYPE)</span>
         DOSE    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">AMT</span><span class="op">)</span> <span class="op">*</span> <span class="va">WT</span>, <span class="fl">2</span><span class="op">)</span>, <span class="co"># DOSE column here (numeric value)</span>
                                             <span class="co"># convert mg/kg (in dataset) to mg</span>
         DOSEREG <span class="op">=</span> <span class="va">DOSE</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># DOSE REGIMEN column here</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span>
  
<span class="co"># convert DOSEREG to factor for proper ordering in the plotting</span>
<span class="co"># add LIDVNORM dose normalized concentration for plotting</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>LIDVNORM    <span class="op">=</span> <span class="va">LIDV</span> <span class="op">/</span> <span class="va">DOSE</span>,
         DOSEREG     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">DOSEREG</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">DOSEREG</span><span class="op">)</span><span class="op">)</span>,
         DOSEREG_REV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">DOSEREG</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">DOSEREG</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
                       <span class="co"># define order of treatment factor</span>
  
<span class="co"># for plotting the PK data</span>
<span class="va">data_pk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">CMT</span> <span class="op">==</span> <span class="fl">2</span>, <span class="va">TIME</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
  
<span class="co"># NCA</span>
<span class="va">NCA</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">CMT</span> <span class="op">==</span> <span class="fl">2</span>, <span class="va">NOMTIME</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="va">NOMTIME</span> <span class="op">&lt;=</span> <span class="fl">24</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>AUC_0_24     <span class="op">=</span> <span class="fu">caTools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caTools/man/trapz.html">trapz</a></span><span class="op">(</span><span class="va">TIME</span>, <span class="va">LIDV</span><span class="op">)</span>,
            Cmax_0_24    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">LIDV</span><span class="op">)</span>,
            Ctrough_0_24 <span class="op">=</span> <span class="va">LIDV</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">LIDV</span><span class="op">)</span><span class="op">]</span>,
            DOSE         <span class="op">=</span> <span class="va">DOSE</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
            WT           <span class="op">=</span> <span class="va">WT</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span><span class="va">PARAM</span>, <span class="va">VALUE</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">DOSE</span>, <span class="va">WT</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>VALUE_NORM <span class="op">=</span> <span class="va">VALUE</span> <span class="op">/</span> <span class="va">DOSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="summary-of-the-data-issues-and-the-covariates" class="section level2">
<h2 class="hasAnchor">
<a href="#summary-of-the-data-issues-and-the-covariates" class="anchor"></a>Summary of the data issues and the covariates</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">check</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xgx_check_data.html">xgx_check_data</a></span><span class="op">(</span><span class="va">data</span>,<span class="va">covariates</span><span class="op">)</span>
<span class="co">#&gt; Warning in xgx_check_data(data, covariates): Setting YTYPE column equal to CMT</span>
<span class="co">#&gt; Warning in xgx_check_data(data, covariates): Setting MDV column equal to as.numeric(EVID!=0)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; DATA SUMMARY</span>
<span class="co">#&gt; CONTINUOUS COVARIATES</span>
<span class="co">#&gt; NO CATEGORICAL COVARIATES</span>
<span class="co">#&gt; POSSIBLE DATA ISSUES - FIRST 6 RECORDS</span>
<span class="co">#&gt; The following columns contained missing values</span>
<span class="co">#&gt; :</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">check</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Category</th>
<th align="left">Description</th>
<th align="left">YTYPE</th>
<th align="left">Statistic</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Patients</td>
<td align="left">Number of Patients</td>
<td align="left">-</td>
<td align="left">12</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="left">MDV</td>
<td align="left">Number of patients with zero PK or PD observations</td>
<td align="left">all</td>
<td align="left">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">MDV</td>
<td align="left">Number of Missing Data Points (MDV==1 and EVID==0)</td>
<td align="left">all</td>
<td align="left">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Dose</td>
<td align="left">Number of non-zero doses</td>
<td align="left">-</td>
<td align="left">12</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">Dose</td>
<td align="left">Number of zero doses (AMT==0)</td>
<td align="left">-</td>
<td align="left">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Dose</td>
<td align="left">Number of patients that never received drug</td>
<td align="left">-</td>
<td align="left">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">DV</td>
<td align="left">Number of Data Points</td>
<td align="left">1</td>
<td align="left">12</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="left">DV</td>
<td align="left">Number of Data Points</td>
<td align="left">2</td>
<td align="left">132</td>
<td align="right">132</td>
</tr>
<tr class="odd">
<td align="left">DV</td>
<td align="left">Number of Data Points per Individual</td>
<td align="left">1</td>
<td align="left">min = 1, median = 1, max = 1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">DV</td>
<td align="left">Number of Data Points per Individual</td>
<td align="left">2</td>
<td align="left">min = 11, median = 11, max = 11</td>
<td align="right">11</td>
</tr>
<tr class="odd">
<td align="left">DV</td>
<td align="left">Number of Data Points with zero value (DV==0)</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">DV</td>
<td align="left">Number of Data Points with zero value (DV==0)</td>
<td align="left">2</td>
<td align="left">9</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="left">DV</td>
<td align="left">Number of Data Points with NA (is.na(DV))</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">DV</td>
<td align="left">Number of Data Points with NA (is.na(DV))</td>
<td align="left">2</td>
<td align="left">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">DV+TIME</td>
<td align="left">Multiple measurements at same time</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">DV+TIME</td>
<td align="left">Multiple measurements at same time</td>
<td align="left">2</td>
<td align="left">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">CENS</td>
<td align="left">Number of Censored Data Points</td>
<td align="left">1</td>
<td align="left">0 (0%)</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">CENS</td>
<td align="left">Number of Censored Data Points</td>
<td align="left">2</td>
<td align="left">0 (0%)</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">All Columns</td>
<td align="left">Negative Values (number)</td>
<td align="left">-</td>
<td align="left">:</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">All Columns</td>
<td align="left">Missing Values (number)</td>
<td align="left">-</td>
<td align="left">:</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">check</span><span class="op">$</span><span class="va">data_subset</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Data_Check_Issue</th>
<th align="right">ID</th>
<th align="right">TIME</th>
<th align="right">DV</th>
<th align="right">CENS</th>
<th align="right">YTYPE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">DV == 0</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">DV == 0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">DV == 0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">DV == 0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">DV == 0</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">DV == 0</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">check</span><span class="op">$</span><span class="va">cts_covariates</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Covariate</th>
<th align="right">Nmissing</th>
<th align="right">min</th>
<th align="right">25th</th>
<th align="right">median</th>
<th align="right">75th</th>
<th align="right">max</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">WT</td>
<td align="right">0</td>
<td align="right">54.6</td>
<td align="right">63.575</td>
<td align="right">70.5</td>
<td align="right">74.425</td>
<td align="right">86.4</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">check</span><span class="op">$</span><span class="va">cat_covariates</span><span class="op">)</span>
<span class="co">#&gt; Warning in kable_pipe(x = structure(character(0), .Dim = c(0L, 0L), .Dimnames =</span>
<span class="co">#&gt; list(: The table should have a header (column names)</span></code></pre></div>
<p>|| || || ||</p>
</div>
<div id="provide-an-overview-of-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#provide-an-overview-of-the-data" class="anchor"></a>Provide an overview of the data</h2>
<p>Summarize the data in a way that is easy to visualize the general trend of PK over time and between doses. Using summary statistics can be helpful, e.g. Mean +/- SE, or median, 5th &amp; 95th percentiles. Consider either coloring by dose or faceting by dose. Depending on the amount of data one graph may be better than the other.</p>
<p>When looking at summaries of PK over time, there are several things to observe. Note the number of doses and number of time points or sampling schedule. Observe the overall shape of the average profiles. What is the average Cmax per dose? Tmax? Does the elimination phase appear to be parallel across the different doses? Is there separation between the profiles for different doses? Can you make a visual estimate of the number of compartments that would be needed in a PK model?</p>
<div id="concentration-over-time-colored-by-dose-mean---95-ci" class="section level3">
<h3 class="hasAnchor">
<a href="#concentration-over-time-colored-by-dose-mean---95-ci" class="anchor"></a>Concentration over Time, colored by dose, mean +/- 95% CI</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">glin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_pk</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NOMTIME</span>,
                                   y <span class="op">=</span> <span class="va">LIDV</span>,
                                   group <span class="op">=</span> <span class="va">DOSE</span>,
                                   color <span class="op">=</span> <span class="va">DOSEREG_REV</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span><span class="va">time_units_dataset</span>, <span class="va">time_units_plot</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">conc_label</span>, color <span class="op">=</span> <span class="st">"Dose"</span><span class="op">)</span>

<span class="va">glog</span> <span class="op">&lt;-</span> <span class="va">glin</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">arrangeGrob</a></span><span class="op">(</span><span class="va">glin</span>, <span class="va">glog</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="theoph_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
<div id="side-by-side-comparison-of-first-administered-dose-and-steady-state" class="section level3">
<h3 class="hasAnchor">
<a href="#side-by-side-comparison-of-first-administered-dose-and-steady-state" class="anchor"></a>Side-by-side comparison of first administered dose and steady state</h3>
<p>For multiple dose studies, zoom in on key visits for a clearer picture of the profiles. Look for accumulation (if any) between first administered dose and steady state.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html">exists</a></span><span class="op">(</span><span class="st">"data_pk_rich"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data_pk_rich</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PROFTIME</span>,
                           y <span class="op">=</span> <span class="va">LIDV</span>,
                           group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html">interaction</a></span><span class="op">(</span><span class="va">CYCLE</span>,<span class="va">DOSE</span><span class="op">)</span>,
                           color <span class="op">=</span> <span class="va">DOSEREG_REV</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">DAY_label</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="../reference/xgx_stat_ci.html">xgx_stat_ci</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span><span class="va">time_units_dataset</span>, <span class="va">time_units_plot</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">conc_label</span>, color <span class="op">=</span> <span class="st">"Dose"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="concentration-over-time-faceted-by-dose-mean---95-ci-overlaid-on-gray-spaghetti-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#concentration-over-time-faceted-by-dose-mean---95-ci-overlaid-on-gray-spaghetti-plots" class="anchor"></a>Concentration over Time, faceted by dose, mean +/- 95% CI, overlaid on gray spaghetti plots</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_pk</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TIME</span>,
                           y <span class="op">=</span> <span class="va">LIDV</span>,
                           group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html">interaction</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">CYCLE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">CENS</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">CENS</span><span class="op">)</span><span class="op">)</span>,
                     size <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_stat_ci.html">xgx_stat_ci</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NOMTIME</span>, group <span class="op">=</span> <span class="cn">NULL</span>, color <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">DOSEREG</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span><span class="va">time_units_dataset</span>, <span class="va">time_units_plot</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="va">conc_label</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey50"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="theoph_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
</div>
<div id="explore-variability" class="section level2">
<h2 class="hasAnchor">
<a href="#explore-variability" class="anchor"></a>Explore variability</h2>
<p>Use spaghetti plots to visualize the extent of variability between individuals. The wider the spread of the profiles, the higher the between subject variability. Distinguish different doses by color, or separate into different panels. If coloring by dose, do the individuals in the different dose groups overlap across doses? Dose there seem to be more variability at higher or lower concentrations?</p>
<div id="concentration-over-time-colored-by-dose-dots-and-lines-grouped-by-individual" class="section level3">
<h3 class="hasAnchor">
<a href="#concentration-over-time-colored-by-dose-dots-and-lines-grouped-by-individual" class="anchor"></a>Concentration over Time, colored by dose, dots and lines grouped by individual</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_pk</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TIME</span>,
                           y <span class="op">=</span> <span class="va">LIDV</span>,
                           group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html">interaction</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">CYCLE</span><span class="op">)</span>,
                           color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">DOSEREG_REV</span><span class="op">)</span>,
                           shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">CENS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span><span class="va">time_units_dataset</span>, <span class="va">time_units_plot</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">conc_label</span>, color <span class="op">=</span> <span class="st">"Dose"</span>, shape <span class="op">=</span> <span class="st">"Censoring"</span><span class="op">)</span></code></pre></div>
<p><img src="theoph_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div id="side-by-side-comparison-of-first-administered-dose-and-steady-state-1" class="section level3">
<h3 class="hasAnchor">
<a href="#side-by-side-comparison-of-first-administered-dose-and-steady-state-1" class="anchor"></a>Side-by-side comparison of first administered dose and steady state</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html">exists</a></span><span class="op">(</span><span class="st">"data_pk_rich"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_pk_rich</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TIME</span>,
                                  y <span class="op">=</span> <span class="va">LIDV</span>,
                                  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html">interaction</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">CYCLE</span><span class="op">)</span>,
                                  color <span class="op">=</span> <span class="va">DOSEREG_REV</span>,
                                  shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">CENS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">DAY_label</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span><span class="va">time_units_dataset</span>, <span class="va">time_units_plot</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">conc_label</span>, color <span class="op">=</span> <span class="st">"Dose"</span>, shape <span class="op">=</span> <span class="st">"Censoring"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="concentration-over-time-faceted-by-dose-lines-grouped-by-individual" class="section level3">
<h3 class="hasAnchor">
<a href="#concentration-over-time-faceted-by-dose-lines-grouped-by-individual" class="anchor"></a>Concentration over Time, faceted by dose, lines grouped by individual</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_pk</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TIME</span>,
                           y <span class="op">=</span> <span class="va">LIDV</span>,
                           group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html">interaction</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">CYCLE</span><span class="op">)</span>,
                           color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">CENS</span><span class="op">)</span>,
                           shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">CENS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">DOSEREG</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span><span class="va">time_units_dataset</span>, <span class="va">time_units_plot</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="va">conc_label</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey50"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<p><img src="theoph_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</div>
</div>
<div id="assess-the-dose-linearity-of-exposure" class="section level2">
<h2 class="hasAnchor">
<a href="#assess-the-dose-linearity-of-exposure" class="anchor"></a>Assess the dose linearity of exposure</h2>
<div id="dose-normalized-concentration-over-time-colored-by-dose-mean---95-ci" class="section level3">
<h3 class="hasAnchor">
<a href="#dose-normalized-concentration-over-time-colored-by-dose-mean---95-ci" class="anchor"></a>Dose Normalized Concentration over Time, colored by dose, mean +/- 95% CI</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_pk</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NOMTIME</span>,
                           y <span class="op">=</span> <span class="va">LIDVNORM</span>,
                           group <span class="op">=</span> <span class="va">DOSEREG_REV</span>,
                           color <span class="op">=</span> <span class="va">DOSEREG_REV</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_stat_ci.html">xgx_stat_ci</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span><span class="va">time_units_dataset</span>, <span class="va">time_units_plot</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">conc_label</span>, color <span class="op">=</span> <span class="st">"Dose"</span><span class="op">)</span></code></pre></div>
<p><img src="theoph_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
<div id="side-by-side-comparison-of-first-administered-dose-and-steady-state-2" class="section level3">
<h3 class="hasAnchor">
<a href="#side-by-side-comparison-of-first-administered-dose-and-steady-state-2" class="anchor"></a>Side-by-side comparison of first administered dose and steady state</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html">exists</a></span><span class="op">(</span><span class="st">"data_pk_rich"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data_pk_rich</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NOMTIME</span>,
                           y <span class="op">=</span> <span class="va">LIDVNORM</span>,
                           group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html">interaction</a></span><span class="op">(</span><span class="va">DOSE</span>, <span class="va">CYCLE</span><span class="op">)</span>,
                           color <span class="op">=</span> <span class="va">DOSEREG_REV</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="../reference/xgx_stat_ci.html">xgx_stat_ci</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">DAY_label</span>,scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span><span class="va">time_units_dataset</span>, <span class="va">time_units_plot</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">conc_label</span>, color <span class="op">=</span> <span class="st">"Dose"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
</div>
<div id="explore-irregularities-in-profiles" class="section level2">
<h2 class="hasAnchor">
<a href="#explore-irregularities-in-profiles" class="anchor"></a>Explore irregularities in profiles</h2>
<p>Plot individual profiles in order to inspect them for any irregularities. Inspect the profiles for outlying data points that may skew results or bias conclusions. Looking at the shapes of the individual profiles now, do they support your observations made about the mean profile (e.g. number of compartments, typical Cmax, Tmax)?</p>
<p>Plotting individual profiles on top of gray spaghetti plots puts individual profiles into context, and may help identify outlying individuals for further inspection. Are there any individuals that appear to have very high or low Cmax compared to others within the same dose group? What about the timing of Cmax? What about the slope of the elimination phase? Does it appear that any subjects could have received an incorrect dose?</p>
<div id="concentration-over-time-faceted-by-individual-individual-line-plots-overlaid-on-gray-spaghetti-plots-for-that-dose-group" class="section level3">
<h3 class="hasAnchor">
<a href="#concentration-over-time-faceted-by-individual-individual-line-plots-overlaid-on-gray-spaghetti-plots-for-that-dose-group" class="anchor"></a>Concentration over Time, faceted by individual, individual line plots overlaid on gray spaghetti plots for that dose group</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_pk</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TIME</span>, y <span class="op">=</span> <span class="va">LIDV</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">CENS</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">CENS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">ID</span> <span class="op">+</span> <span class="va">DOSEREG</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span><span class="op">(</span><span class="va">time_units_dataset</span>, <span class="va">time_units_plot</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="va">conc_label</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="theoph_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
</div>
</div>
<div id="nca" class="section level2">
<h2 class="hasAnchor">
<a href="#nca" class="anchor"></a>NCA</h2>
<div id="nca-of-dose-normalized-auc-vs-dose" class="section level3">
<h3 class="hasAnchor">
<a href="#nca-of-dose-normalized-auc-vs-dose" class="anchor"></a>NCA of dose normalized AUC vs Dose</h3>
<p>Observe the dose normalized AUC over different doses. Does the relationship appear to be constant across doses or do some doses stand out from the rest? Can you think of reasons why some would stand out? For example, the lowest dose may have dose normalized AUC much higher than the rest, could this be due to CENS observations? If the highest doses have dose normalized AUC much higher than the others, could this be due to nonlinear clearance, with clearance saturating at higher doses? If the highest doses have dose normalized AUC much lower than the others, could there be saturation of bioavailability, reaching the maximum absorbable dose?</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html">exists</a></span><span class="op">(</span><span class="st">"NCA"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/warning.html">warning</a></span><span class="op">(</span><span class="st">"For PK data exploration, it is highly recommended to perform an NCA"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">NCA</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DOSE</span>, y <span class="op">=</span> <span class="va">VALUE_NORM</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">DOSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PARAM</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="../reference/xgx_scale_x_log10.html">xgx_scale_x_log10</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">NCA</span><span class="op">$</span><span class="va">DOSE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dose_label</span>, y <span class="op">=</span> <span class="va">concnorm_label</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="theoph_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
</div>
</div>
<div id="covariate-effects" class="section level2">
<h2 class="hasAnchor">
<a href="#covariate-effects" class="anchor"></a>Covariate Effects</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html">exists</a></span><span class="op">(</span><span class="st">"NCA"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/warning.html">warning</a></span><span class="op">(</span><span class="st">"For covariate exploration, it is highly recommended to perform an NCA"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="va">NCA_cts</span> <span class="op">&lt;-</span> <span class="va">NCA</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PARAM"</span>, <span class="st">"VALUE"</span>, <span class="va">check</span><span class="op">$</span><span class="va">cts_covariates</span><span class="op">$</span><span class="va">Covariate</span><span class="op">)</span><span class="op">]</span> <span class="op">%&gt;%</span>
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span><span class="va">COV</span>, <span class="va">COV_VALUE</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">PARAM</span>, <span class="va">VALUE</span><span class="op">)</span><span class="op">)</span>
  
  <span class="va">NCA_cat</span> <span class="op">&lt;-</span> <span class="va">NCA</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PARAM"</span>, <span class="st">"VALUE"</span>, <span class="va">check</span><span class="op">$</span><span class="va">cat_covariates</span><span class="op">$</span><span class="va">Covariate</span><span class="op">)</span><span class="op">]</span> <span class="op">%&gt;%</span>
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span><span class="va">COV</span>, <span class="va">COV_VALUE</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">PARAM</span>, <span class="va">VALUE</span><span class="op">)</span><span class="op">)</span>
  
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">check</span><span class="op">$</span><span class="va">cts_covariates</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">NCA_cts</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">COV_VALUE</span>, y <span class="op">=</span> <span class="va">VALUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">PARAM</span><span class="op">~</span><span class="va">COV</span>,switch <span class="op">=</span> <span class="st">"y"</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="../reference/xgx_scale_x_log10.html">xgx_scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Covariate Value"</span>, y <span class="op">=</span> <span class="st">"NCA Parameter Value"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">gg</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">check</span><span class="op">$</span><span class="va">cat_covariates</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">NCA_cat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">COV_VALUE</span>, y <span class="op">=</span> <span class="va">VALUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">PARAM</span><span class="op">~</span><span class="va">COV</span>, switch <span class="op">=</span> <span class="st">"y"</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="../reference/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Covariate Value"</span>, y <span class="op">=</span> <span class="st">"NCA Parameter Value"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">gg</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p><img src="theoph_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Andrew Stein, Alison Margolskee, Fariba Khanshan, Konstantin Krismer, Novartis Pharma AG.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
