<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Wrapper for stat_smooth — xgx_stat_smooth • xgxr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Wrapper for stat_smooth — xgx_stat_smooth" />
<meta property="og:description" content="xgx_stat_smooth and xgx_geom_smooth produce smooth fits through continuous or categorical data. 
For categorical, ordinal, or multinomial data use method = polr. 
This wrapper also works with nonlinear methods like nls and nlsLM for continuous data.
xgx_geom_smooth_emax uses minpack.lm::nlsLM, predictdf.nls, and stat_smooth to display Emax model fit to data" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xgxr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/sad_pkpd.html">PKPD Single Ascending Dose example</a>
    </li>
    <li>
      <a href="../articles/theoph.html">PK Exploration with nlmixr dataset</a>
    </li>
    <li>
      <a href="../articles/xgxr_overview.html">xgxr Overview</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Wrapper for stat_smooth</h1>
    
    <div class="hidden name"><code>xgx_stat_smooth.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>xgx_stat_smooth</code> and <code>xgx_geom_smooth</code> produce smooth fits through continuous or categorical data. 
For categorical, ordinal, or multinomial data use method = polr. 
This wrapper also works with nonlinear methods like nls and nlsLM for continuous data.</p>
<p><code>xgx_geom_smooth_emax</code> uses minpack.lm::nlsLM, predictdf.nls, and stat_smooth to display Emax model fit to data</p>
    </div>

    <pre class="usage"><span class='fu'>xgx_stat_smooth</span><span class='op'>(</span>
  mapping <span class='op'>=</span> <span class='cn'>NULL</span>,
  data <span class='op'>=</span> <span class='cn'>NULL</span>,
  geom <span class='op'>=</span> <span class='st'>"smooth"</span>,
  position <span class='op'>=</span> <span class='st'>"identity"</span>,
  <span class='va'>...</span>,
  method <span class='op'>=</span> <span class='cn'>NULL</span>,
  formula <span class='op'>=</span> <span class='cn'>NULL</span>,
  se <span class='op'>=</span> <span class='cn'>TRUE</span>,
  n <span class='op'>=</span> <span class='fl'>80</span>,
  span <span class='op'>=</span> <span class='fl'>0.75</span>,
  n_boot <span class='op'>=</span> <span class='fl'>200</span>,
  fullrange <span class='op'>=</span> <span class='cn'>FALSE</span>,
  level <span class='op'>=</span> <span class='fl'>0.95</span>,
  method.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  na.rm <span class='op'>=</span> <span class='cn'>FALSE</span>,
  orientation <span class='op'>=</span> <span class='st'>"x"</span>,
  show.legend <span class='op'>=</span> <span class='cn'>NA</span>,
  inherit.aes <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>xgx_geom_smooth</span><span class='op'>(</span>
  mapping <span class='op'>=</span> <span class='cn'>NULL</span>,
  data <span class='op'>=</span> <span class='cn'>NULL</span>,
  geom <span class='op'>=</span> <span class='st'>"smooth"</span>,
  position <span class='op'>=</span> <span class='st'>"identity"</span>,
  <span class='va'>...</span>,
  method <span class='op'>=</span> <span class='cn'>NULL</span>,
  formula <span class='op'>=</span> <span class='cn'>NULL</span>,
  se <span class='op'>=</span> <span class='cn'>TRUE</span>,
  n <span class='op'>=</span> <span class='fl'>80</span>,
  span <span class='op'>=</span> <span class='fl'>0.75</span>,
  fullrange <span class='op'>=</span> <span class='cn'>FALSE</span>,
  level <span class='op'>=</span> <span class='fl'>0.95</span>,
  method.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  na.rm <span class='op'>=</span> <span class='cn'>FALSE</span>,
  orientation <span class='op'>=</span> <span class='st'>"x"</span>,
  show.legend <span class='op'>=</span> <span class='cn'>NA</span>,
  inherit.aes <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>xgx_geom_smooth_emax</span><span class='op'>(</span>
  mapping <span class='op'>=</span> <span class='cn'>NULL</span>,
  data <span class='op'>=</span> <span class='cn'>NULL</span>,
  geom <span class='op'>=</span> <span class='st'>"smooth"</span>,
  position <span class='op'>=</span> <span class='st'>"identity"</span>,
  <span class='va'>...</span>,
  method <span class='op'>=</span> <span class='st'>"nlsLM"</span>,
  <span class='va'>formula</span>,
  se <span class='op'>=</span> <span class='cn'>TRUE</span>,
  n <span class='op'>=</span> <span class='fl'>80</span>,
  span <span class='op'>=</span> <span class='fl'>0.75</span>,
  fullrange <span class='op'>=</span> <span class='cn'>FALSE</span>,
  level <span class='op'>=</span> <span class='fl'>0.95</span>,
  method.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  na.rm <span class='op'>=</span> <span class='cn'>FALSE</span>,
  orientation <span class='op'>=</span> <span class='st'>"x"</span>,
  show.legend <span class='op'>=</span> <span class='cn'>NA</span>,
  inherit.aes <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mapping</th>
      <td><p>Set of aesthetic mappings created by `aes` or `aes_`. 
If specified and `inherit.aes = TRUE` (the default), it is combined with the 
default mapping at the top level of the plot. You must supply mapping if 
there is no plot mapping.
Warning: for `method = polr`, do not define `y` aesthetic, use `response` instead.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>The data to be displayed in this layer. There are three options:</p>
<p>If NULL, the default, the data is inherited from the plot data as specified 
in the call to ggplot.</p>
<p>A data.frame, or other object, will override the plot data. All objects 
will be fortified to produce a data frame. See fortify for which variables 
will be created.</p>
<p>A function will be called with a single argument, the plot data. The return 
value must be a data.frame., and will be used as the layer data.</p></td>
    </tr>
    <tr>
      <th>geom</th>
      <td><p>Use to override the default geom. Can be a list of multiple 
geoms, e.g. list("point","line","errorbar"), which is the default.</p></td>
    </tr>
    <tr>
      <th>position</th>
      <td><p>Position adjustment, either as a string, or the result of 
a call to a position adjustment function.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments passed on to layer. These are often aesthetics, 
used to set an aesthetic to a fixed value, like color = "red" or size = 3. 
They may also be parameters to the paired geom/stat.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>method (function) to use, eg. lm, glm, gam, loess, rlm. 
Example: `"polr"` for ordinal data. `"nlsLM"` for nonlinear least squares.
If method is left as `NULL`, then a typical `StatSmooth` is applied, 
with the corresponding defaults, i.e. For datasets with n &lt; 1000 default is loess. 
For datasets with 1000 or more observations defaults to gam.</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>formula to use in smoothing function, eg. y ~ x, y ~ poly(x, 2), y ~ log(x)</p></td>
    </tr>
    <tr>
      <th>se</th>
      <td><p>display confidence interval around smooth? (TRUE by default, see level to control)</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>number of points to evaluate smoother at</p></td>
    </tr>
    <tr>
      <th>span</th>
      <td><p>Controls the amount of smoothing for the default loess smoother. 
Smaller numbers produce wigglier lines, larger numbers produce smoother lines.</p></td>
    </tr>
    <tr>
      <th>n_boot</th>
      <td><p>number of bootstraps to perform to compute confidence interval, 
currently only used for method = "polr", default is 200</p></td>
    </tr>
    <tr>
      <th>fullrange</th>
      <td><p>should the fit span the full range of the plot, or just the data</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>The percentile for the confidence interval (should fall 
between 0 and 1). The default is 0.95, which corresponds to a 95 percent 
confidence interval.</p></td>
    </tr>
    <tr>
      <th>method.args</th>
      <td><p>Optional additional arguments passed on to the method.</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>If FALSE, the default, missing values are removed with a 
warning. If TRUE, missing values are silently removed.</p></td>
    </tr>
    <tr>
      <th>orientation</th>
      <td><p>The orientation of the layer, passed on to ggplot2::stat_summary. 
Only implemented for ggplot2 v.3.3.0 and later. The default ("x") summarizes y values over
x values (same behavior as ggplot2 v.3.2.1 or earlier). Setting <code>orientation = "y"</code> will 
summarize x values over y values, which may be useful in some situations where you want to flip
the axes, e.g. to create forest plots. Setting <code>orientation = NA</code> will try to automatically
determine the orientation from the aesthetic mapping (this is more stable for ggplot2 v.3.3.2
compared to v.3.3.0).</p></td>
    </tr>
    <tr>
      <th>show.legend</th>
      <td><p>logical. Should this layer be included in the legends? 
NA, the default, includes if any aesthetics are mapped. FALSE never 
includes, and TRUE always includes.</p></td>
    </tr>
    <tr>
      <th>inherit.aes</th>
      <td><p>If FALSE, overrides the default aesthetics, rather 
than combining with them. This is most useful for helper functions that 
define both data and aesthetics and shouldn't inherit behaviour from the 
default plot specification, e.g. borders.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>ggplot2 plot layer</p>
    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    

<p><code>nlsLM</code> uses <code>nls.lm</code> which implements the Levenberg-Marquardt
algorithm for fitting a nonlinear model, and may fail to converge for a
number of reasons. See <code>?nls.lm</code> for more information.</p>
<p><code>nls</code> uses Gauss-Newton method for estimating parameters, 
and could fail if the parameters are not identifiable. If this happens 
you will see the following warning message: 
Warning message:
Computation failed in `stat_smooth()`:
  singular gradient</p>  
<p><code>nls</code> will also fail if used on artificial "zero-residual" data, 
use <code>nlsLM</code> instead.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='predictdf.nls.html'>predictdf.nls</a></code> for information on how nls confidence intervals are calculated.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Example with nonlinear least squares (method = "nlsLM")</span>
<span class='va'>Nsubj</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
<span class='va'>Doses</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>25</span>, <span class='fl'>50</span>, <span class='fl'>100</span>, <span class='fl'>200</span><span class='op'>)</span>
<span class='va'>Ntot</span> <span class='op'>&lt;-</span> <span class='va'>Nsubj</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>Doses</span><span class='op'>)</span>
<span class='va'>times</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>14</span>,<span class='fl'>30</span>,<span class='fl'>60</span>,<span class='fl'>90</span><span class='op'>)</span>

<span class='va'>dat1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='op'>(</span><span class='va'>Ntot</span><span class='op'>)</span>,
                   DOSE <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>Doses</span>, <span class='va'>Nsubj</span><span class='op'>)</span>,
                   PD0 <span class='op'>=</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Lognormal.html'>rlnorm</a></span><span class='op'>(</span><span class='va'>Ntot</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>, <span class='fl'>1</span><span class='op'>)</span>,
                   Kout <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>Ntot</span>,<span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>0.3</span><span class='op'>)</span><span class='op'>)</span>,
                   Imax <span class='op'>=</span> <span class='fl'>1</span>,
                   ED50 <span class='op'>=</span> <span class='fl'>25</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>PDSS <span class='op'>=</span> <span class='va'>PD0</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>-</span> <span class='va'>Imax</span><span class='op'>*</span><span class='va'>DOSE</span><span class='op'>/</span><span class='op'>(</span><span class='va'>DOSE</span> <span class='op'>+</span> <span class='va'>ED50</span><span class='op'>)</span><span class='op'>)</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>Ntot</span>, <span class='fl'>0.05</span>, <span class='fl'>0.3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='op'>(</span><span class='va'>Ntot</span><span class='op'>)</span>, each <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>times</span><span class='op'>)</span><span class='op'>)</span>, Time <span class='op'>=</span> <span class='va'>times</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>PD <span class='op'>=</span> <span class='op'>(</span><span class='op'>(</span><span class='va'>PD0</span> <span class='op'>-</span> <span class='va'>PDSS</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Kout</span><span class='op'>*</span><span class='va'>Time</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>PDSS</span><span class='op'>)</span>, 
                PCHG <span class='op'>=</span> <span class='op'>(</span><span class='va'>PD</span> <span class='op'>-</span> <span class='va'>PD0</span><span class='op'>)</span><span class='op'>/</span><span class='va'>PD0</span><span class='op'>)</span>

<span class='va'>gg</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat1</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>Time</span> <span class='op'>==</span> <span class='fl'>90</span><span class='op'>)</span>, 
                      <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>DOSE</span>, y <span class='op'>=</span> <span class='va'>PCHG</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span><span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>DOSE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='xgx_theme.html'>xgx_theme</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='xgx_scale_y_percentchangelog10.html'>xgx_scale_y_percentchangelog10</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Percent Change from Baseline"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Dose (mg)"</span><span class='op'>)</span>

<span class='va'>gg</span> <span class='op'>+</span>
  <span class='fu'>xgx_stat_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"nlsLM"</span>, formula <span class='op'>=</span> <span class='va'>y</span> <span class='op'>~</span> <span class='va'>E0</span> <span class='op'>+</span> <span class='va'>Emax</span><span class='op'>*</span><span class='va'>x</span><span class='op'>/</span><span class='op'>(</span><span class='va'>ED50</span> <span class='op'>+</span> <span class='va'>x</span><span class='op'>)</span>,
                  method.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
                    start <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Emax <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.50</span>, ED50 <span class='op'>=</span> <span class='fl'>25</span>, E0 <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>,
                    lower <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='cn'>Inf</span>, <span class='fl'>0</span>, <span class='op'>-</span><span class='cn'>Inf</span><span class='op'>)</span>
                  <span class='op'>)</span>,
                  se <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Ignoring unknown parameters: n_boot</span></div><div class='img'><img src='xgx_stat_smooth-1.png' alt='' width='700' height='433' /></div><div class='input'>              
<span class='va'>gg</span> <span class='op'>+</span> 
  <span class='fu'>xgx_geom_smooth_emax</span><span class='op'>(</span><span class='op'>)</span>  
</div><div class='output co'>#&gt; <span class='warning'>Warning: Formula not specified.</span>
#&gt; <span class='warning'>Using default formula y ~ E0 + Emax*x/(ED50 + x), </span>
#&gt; <span class='warning'>            initializing E0, Emax, and ED50 to 1, </span>
#&gt; <span class='warning'>            and setting lower bound on ED50 to 0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Ignoring unknown parameters: n_boot</span></div><div class='img'><img src='xgx_stat_smooth-2.png' alt='' width='700' height='433' /></div><div class='input'>  
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>  
<span class='co'># example with ordinal data (method = "polr")</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span>
<span class='va'>data</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>120</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>,
                  response <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Mild"</span>,<span class='st'>"Moderate"</span>,<span class='st'>"Severe"</span><span class='op'>)</span>, <span class='fl'>100</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
                  covariate <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Male"</span>,<span class='st'>"Female"</span><span class='op'>)</span>, <span class='fl'>100</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='op'>(</span><span class='fl'>50</span> <span class='op'>+</span> <span class='fl'>20</span><span class='op'>*</span><span class='va'>x</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>200</span> <span class='op'>+</span> <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fl'>0</span>, <span class='fl'>0.3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  
<span class='co'># example coloring by the response categories</span>
<span class='fu'><a href='xgx_plot.html'>xgx_plot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>data</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>xgx_stat_smooth</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, response <span class='op'>=</span> <span class='va'>response</span>,
                                         colour <span class='op'>=</span> <span class='va'>response</span>, fill <span class='op'>=</span> <span class='va'>response</span><span class='op'>)</span>,
                  method <span class='op'>=</span> <span class='st'>"polr"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/label_percent.html'>percent_format</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>


<span class='co'># example faceting by the response categories, coloring by a different covariate </span>
<span class='fu'><a href='xgx_plot.html'>xgx_plot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>data</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>xgx_stat_smooth</span><span class='op'>(</span>mapping <span class='op'>=</span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, response <span class='op'>=</span> <span class='va'>response</span>, 
                                       colour <span class='op'>=</span> <span class='va'>covariate</span>, fill <span class='op'>=</span> <span class='va'>covariate</span><span class='op'>)</span>,
                method <span class='op'>=</span> <span class='st'>"polr"</span>, level <span class='op'>=</span> <span class='fl'>0.80</span><span class='op'>)</span> <span class='op'>+</span> 
                <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>response</span><span class='op'>)</span> <span class='op'>+</span> 
                <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/label_percent.html'>percent_format</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andrew Stein, Alison Margolskee, Fariba Khanshan, Konstantin Krismer, Novartis Pharma AG.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


